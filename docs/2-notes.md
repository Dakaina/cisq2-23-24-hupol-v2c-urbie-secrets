| Prioriteit(MOSCOW) | Omschrijving                                                                                                                                                                     | Fix                                                                                                                                                                                                                                                                                                                            | Bron                                                                                          |
|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| Must fix           | Wachtwoord wordt opgeslagen als plain text bij account registratie bij AuthenticationService.java en AdminService.java                                                           | PasswordEncoder bij services toegevoegd en voordat user gecreeerd en opgeslagen wordt in databse wordt password nu eerst nog geencode via .encode()                                                                                                                                                                            | OWASP A3:2017 – Sensitive Data Exposure: plain text passwords                                 |
| Should fix         | Wachtwoordt wordt niet gesalt/peppered bij AuthenticaitonService.java en AdminService.java                                                                                       | PasswordEncoder gebruikt BCrypt en die salt automatisch voor encoden, daarnaast ook nog los een pepper in secret file die toegevoegd wordt aan einde van wachtwoord bij registreren en inloggen voor het encoden en bij inloggen                                                                                               | OWASP A3:2017 – Sensitive Data Exposure: weakly secured                                       |
| Must fix           | Wachtwoord wordt vergeleken met .equals methode bij inloggen bij AuthenticationService.java                                                                                      | .equals vervangen door PasswordEncoder .matches functie                                                                                                                                                                                                                                                                        | Timing attack                                                                                 |
| Should fix         | Username wordt via url gegeven bij het promoten/demoten van admin rol in AuthenticationController.java                                                                           | Path variable eruit gehaald en vervangen door requestbody via AdminRequest.java                                                                                                                                                                                                                                                | OWASP A3:2017 – Sensitive Data Exposure: exposed in url                                       |
| Should fix         | JWT expiration time is 10 dagen bij application.properties                                                                                                                       | JWT Expiration time van 10 dagen veranderd naar 30 minutes. Applicatie is alleen importen van votes/candidates en resultaten bekijken en dus zou 30 minuten meer dan genoeg moeten zijn voor meeste usecases                                                                                                                   | OWASP A2:2017 – Broken Authentication: Too long session timeouts                              |
| Should fix         | Zwakke, kleine, bekende wachtwoorden worden toegelaten bij registreren                                                                                                           | Bij RegisterRequest.java een minSize van 12 toegevoegd en een RegEx pattern die wilt dat een wachtwoord minimaal 2 kleine letters, 2 grote letters, 2 nummers, 2 punctuation marks bevat. Hiermee is een blacklist van bekende wachtwoorden niet nodig sinds bekende wachtwoorden niet voldoen aan de toegevoegde restrictions | OWASP A2:2017 – Broken Authentication: Credential stuffing through commonly used passwords    |
| Wont fix           | Er wordt niks gelogged                                                                                                                                                           | Bij application.properties Springs built in logging enabled op info mode (niet debug mode want die geeft te veel info)                                                                                                                                                                                                         | OWASP A10:2017 – Insufficient Logging & Monitoring                                            |
| Should fix         | Er zijn unused imports op verschillende plekken                                                                                                                                  | Ctrl+Alt+O heeft alle unused imports weggehaald                                                                                                                                                                                                                                                                                | OWASP A6:2017 – Security Misconfiguration: Unused imports                                     |
| Must fix           | Hardcoded credentials in application.properties                                                                                                                                  | In secret.properties op local. Tijdens een push worden values voor de build pipeline vervangen via github secrets                                                                                                                                                                                                              | OWASP A3:2017 – Sensitive Data Exposure: hardcoded credentials                                |
| Must fix           | Hardcoded credentials in docker-compose.yml                                                                                                                                      | Docker secrets gecreeerd en de echte credentials in docker-compose.yml vervangen door placeholders die weer worden vervangen bij het runnen                                                                                                                                                                                    | OWASP A3:2017 – Sensitive Data Exposure: hardcoded credentials                                |
| Must fix           | Hardcoded credentials in StartupRunner.java                                                                                                                                      | In secret.properties op local. Tijdens een push worden values voor de build pipeline vervangen via github secrets                                                                                                                                                                                                              | OWASP A3:2017 – Sensitive Data Exposure: hardcoded credentials                                |
| Should fix         | Hardcoded credentials zijn te simpel te raden                                                                                                                                    | Vervanged door meer complicated usernames/passwords in secrets                                                                                                                                                                                                                                                                 | OWASP A2:2017 – Broken Authentication: commonly used credentials                              |
| Should fix         | Registratie kan op 2 punten, Authenticationservice.java en Adminservice.java, dit kan voor inconsistency zorgen sinds er vergeten kan worden om op 2 punten dingen aan te passen | Adminservice.java gebruik laten maken van Authenticationservice.java register methode om accounts te registreren en daarna via Admins promote functie de gebruiker de admin rol geven                                                                                                                                          | OWASP A6:2017 – Security Misconfiguration                                                     |
| Must fix           | Outdated dependency org.springframework.boot:spring-boot-starter-web                                                                                                             | Dependency geupdate van versie 3.2.3 naar 3.2.5                                                                                                                                                                                                                                                                                | Snyk & OWASP A6:2017 – Security Misconfiguration: Not up to date                              |
| Must fix           | Outdated dependency org.springframework.security:spring-security-test                                                                                                            | Bij updaten van andere dependency is vulnerability ermee opgelost                                                                                                                                                                                                                                                              | Snyk & OWASP A6:2017 – Security Misconfiguration: Not up to date                              |
| Wont fix           | Remote Code Execution bij comS.h2database                                                                                                                                        | Dit is vooral een probleem bij het overwriten van de default WebAllowOthers van false naar true, dit gebeurt niet in onze applicatie dus ik heb een .snyk file aangemaakt waar de vulnerability geignored wordt                                                                                                                | Snyk & OWASP A9:2017 – Using Components with Known Vulnerabilities                            |
| Must fix           | Improper access control in org.springramework.security                                                                                                                           | Bij updaten van andere dependency is vulnerability ermee opgelost                                                                                                                                                                                                                                                              | Snyk & OWASP A6:2017 – Security Misconfiguration: Not up to date                              |
| Wont fix           | Hardcoded credentials in AuthenticationControllerWebTest line 44, 45, 62, 63                                                                                                     | Test credentials zijn heel simpel en werken alleen in test environment bij specifieke tests dus niet nodig om te vervangen met secrets                                                                                                                                                                                         | Snyk                                                                                          |
| Could fix          | Password hash with insufficient computational effort in /fakedatagenerator/index.js line 13                                                                                      | Hashmethode van md5 naar sha256 veranderd                                                                                                                                                                                                                                                                                      | Snyk                                                                                          |
| Must fix           | Request forgery in SecurityConfig.java line 50                                                                                                                                   | Op mysterieuze wijze verdwenen                                                                                                                                                                                                                                                                                                 | Snyk                                                                                          |
| Wont fix           | Er is geen 2 factor authentication                                                                                                                                               | Niet gedaan maar bv te fixen door een email service te hebben die een code stuurt naar user bij proberen inloggen en user die code erbij nog laten invullen                                                                                                                                                                    | OWASP A2:2017 – Broken Authentication: Having a password as only factor                       |
| Must fix           | Geen role based authorization bij controllers waardoor users potentieel admin dingen zouden kunnen doen                                                                          | @Secured bij alle controllers toegevoegd waar alleen users met rollen bij zouden moeten kunnen komen                                                                                                                                                                                                                           | OWASP A5:2017 – Broken Access Control: Able to use authenticated endpoints not meant for user |
| Should fix         | Wordt niet gecheckt of dependencies/plugins end of life zijn, outdated etc.                                                                                                      | Snyk gedownload die pom checkt voor outdated/unsecure dingen                                                                                                                                                                                                                                                                   | OWASP A9:2017 – Using Components with Known Vulnerabilities                                   |
| Should fix         | Nog op java 17 in pom.xml                                                                                                                                                        | Update naar java 21                                                                                                                                                                                                                                                                                                            | Snyk & OWASP A6:2017 – Security Misconfiguration: Not up to date                              |
| Must fix           | Cross-Site Request Forgery (CSRF) disabled in SecurityConfig                                                                                                                     | Aangezet met een hele basic implementation die een csrf token in een cookie geeft voor de frontend om op te pakken                                                                                                                                                                                                             | Snyk & OWASP A6:2017 – CSRF                                                                   |

Wat doet dit voor maintainability?: